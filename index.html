<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pola / Patterns - Matematik Tingkatan 2</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Fredoka+One:wght@400&family=Nunito:wght@400;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }
        
        .header h1 {
            font-family: 'Fredoka One', cursive;
            font-size: 3rem;
            font-weight: 400;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            letter-spacing: 2px;
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .language-toggle {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
        }
        
        .lang-btn {
            padding: 10px 20px;
            border: 2px solid white;
            background: transparent;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .lang-btn.active {
            background: white;
            color: #667eea;
        }
        
        .lang-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .lang-btn.active:hover {
            background: white;
        }
        
        .progress-bar {
            background: rgba(255, 255, 255, 0.2);
            height: 8px;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: white;
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }
        
        .card-container {
            perspective: 1000px;
            margin-bottom: 30px;
        }
        
        .flashcard {
            width: 100%;
            max-width: 600px;
            height: 400px;
            margin: 0 auto;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            cursor: pointer;
        }
        
        .flashcard.flipped {
            transform: rotateY(180deg);
        }
        
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 20px;
            padding: 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .card-front {
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
            color: #2c2c2c;
        }
        
        .card-back {
            background: linear-gradient(135deg, #48cae4 0%, #023e8a 100%);
            color: white;
            transform: rotateY(180deg);
        }
        
        .card-title {
            font-family: 'Nunito', sans-serif;
            font-size: 1.8rem;
            font-weight: 800;
            margin-bottom: 20px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .card-content {
            font-size: 1.1rem;
            line-height: 1.6;
        }
        
        .pattern-visual {
            margin: 20px 0;
            font-size: 2.5rem;
            letter-spacing: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .shape {
            display: inline-block;
            width: 40px;
            height: 40px;
            margin: 5px;
            border-radius: 50%;
            position: relative;
        }
        
        .shape.circle {
            border-radius: 50%;
        }
        
        .shape.square {
            border-radius: 8px;
        }
        
        .shape.triangle {
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-radius: 0;
            margin: 10px;
        }
        
        .shape.red { background-color: #ff6b6b; }
        .shape.blue { background-color: #4ecdc4; }
        .shape.green { background-color: #45b7d1; }
        .shape.yellow { background-color: #f9ca24; }
        .shape.purple { background-color: #a55eea; }
        
        .shape.triangle.red { border-bottom: 35px solid #ff6b6b; }
        .shape.triangle.blue { border-bottom: 35px solid #4ecdc4; }
        .shape.triangle.green { border-bottom: 35px solid #45b7d1; }
        .shape.triangle.yellow { border-bottom: 35px solid #f9ca24; }
        .shape.triangle.purple { border-bottom: 35px solid #a55eea; }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #ff5252 0%, #ffb300 100%);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.1) 100%);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .btn-secondary:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.3) 0%, rgba(255, 255, 255, 0.2) 100%);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }
        
        .card-counter {
            color: white;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.1rem;
        }
        
        .flip-hint {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }
        
        .interactive-features {
            margin-top: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }
        
        .feature-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .btn-feature {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
            padding: 10px 18px;
            font-size: 0.9rem;
            border-radius: 20px;
            transition: all 0.3s ease;
        }
        
        .btn-feature:hover {
            background: linear-gradient(135deg, #96e6db 0%, #fcc8d1 100%);
            transform: translateY(-2px);
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 10% auto;
            padding: 30px;
            border-radius: 20px;
            width: 80%;
            max-width: 500px;
            color: white;
            position: relative;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .close {
            position: absolute;
            right: 20px;
            top: 15px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: white;
        }
        
        .close:hover {
            opacity: 0.7;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-item {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            color: #feca57;
            font-family: 'Nunito', sans-serif;
        }
        
        .stat-label {
            font-size: 0.9rem;
            margin-top: 5px;
            opacity: 0.9;
        }
        
        .learned-card {
            border: 3px solid #feca57 !important;
            box-shadow: 0 0 20px rgba(254, 202, 87, 0.5) !important;
        }
        
        .dark-mode {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%) !important;
        }
        
        .dark-mode .card-front {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%) !important;
            color: white !important;
        }
        
        .dark-mode .card-back {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%) !important;
        }
        
        .instructions {
            margin-bottom: 30px;
        }
        
        .instruction-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.05) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 25px;
            color: white;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .instruction-card h3 {
            font-family: 'Nunito', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 20px;
            text-align: center;
            color: #feca57;
        }
        
        .instruction-content {
            display: grid;
            gap: 12px;
        }
        
        .instruction-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .instruction-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }
        
        .instruction-icon {
            font-size: 1.2rem;
            min-width: 25px;
        }
        
        .instruction-item span:last-child {
            font-size: 0.95rem;
            line-height: 1.4;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }
            
            .flashcard {
                height: 350px;
            }
            
            .card-face {
                padding: 30px 20px;
            }
            
            .controls {
                gap: 10px;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            .feature-row {
                gap: 8px;
            }
            
            .btn-feature {
                padding: 8px 12px;
                font-size: 0.8rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .modal-content {
                width: 90%;
                margin: 20% auto;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Pola / Patterns</h1>
            <p>Matematik Tingkatan 2 - Bab 1</p>
        </div>
        
        <!-- Instructions Section -->
        <div class="instructions">
            <div class="instruction-card">
                <h3 id="instruction-title">📚 Cara Menggunakan Flash Card Ini</h3>
                <div class="instruction-content">
                    <div class="instruction-item">
                        <span class="instruction-icon">🔄</span>
                        <span id="instruction-1">Klik kad atau tekan spacebar untuk membalikkan dan lihat jawapan</span>
                    </div>
                    <div class="instruction-item">
                        <span class="instruction-icon">⭐</span>
                        <span id="instruction-2">Tekan "Sudah Faham" untuk tandakan kad yang sudah dikuasai</span>
                    </div>
                    <div class="instruction-item">
                        <span class="instruction-icon">▶️</span>
                        <span id="instruction-3">Gunakan "Auto Play" untuk pembelajaran automatik setiap 3 saat</span>
                    </div>
                    <div class="instruction-item">
                        <span class="instruction-icon">📊</span>
                        <span id="instruction-4">Lihat "Statistik" untuk pantau kemajuan pembelajaran anda</span>
                    </div>
                    <div class="instruction-item">
                        <span class="instruction-icon">📝</span>
                        <span id="instruction-5">Tekan "Export Nota" untuk muat turun semua nota dalam fail .txt untuk rujukan offline</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="language-toggle">
            <button class="lang-btn active" onclick="setLanguage('bm')">Bahasa Melayu</button>
            <button class="lang-btn" onclick="setLanguage('en')">English</button>
        </div>
        
        <div class="card-counter">
            <span id="current-card">1</span> / <span id="total-cards">8</span>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progress"></div>
        </div>
        
        <div class="card-container">
            <div class="flashcard" id="flashcard" onclick="flipCard()">
                <div class="card-face card-front">
                    <div class="card-title" id="front-title">Apakah pola?</div>
                    <div class="card-content" id="front-content">
                        Terangkan konsep asas pola dalam matematik.
                    </div>
                </div>
                <div class="card-face card-back">
                    <div class="card-title" id="back-title">Jawapan</div>
                    <div class="card-content" id="back-content">
                        Pola ialah susunan objek, nombor atau bentuk yang mengikut peraturan tertentu dan berulang secara konsisten.
                    </div>
                </div>
            </div>
            <div class="flip-hint">Klik kad untuk membalikkan</div>
        </div>
        
        <div class="controls">
            <button class="btn btn-secondary" onclick="previousCard()">⬅ Sebelum</button>
            <button class="btn btn-primary" onclick="flipCard()">Balikkan Kad</button>
            <button class="btn btn-secondary" onclick="nextCard()">Seterusnya ➡</button>
            <button class="btn btn-secondary" onclick="shuffleCards()">🔀 Kacau</button>
        </div>
        
        <!-- New Interactive Features -->
        <div class="interactive-features">
            <div class="feature-row">
                <button class="btn btn-feature" onclick="toggleAutoPlay()">
                    <span id="autoplay-icon">▶️</span> <span id="autoplay-text">Auto Play</span>
                </button>
                <button class="btn btn-feature" onclick="markAsLearned()">
                    <span id="learned-icon">⭐</span> <span id="learned-text">Sudah Faham</span>
                </button>
                <button class="btn btn-feature" onclick="showStats()">
                    📊 <span id="stats-text">Statistik</span>
                </button>
            </div>
            <div class="feature-row">
                <button class="btn btn-feature" onclick="resetProgress()">
                    🔄 <span id="reset-text">Reset</span>
                </button>
                <button class="btn btn-feature" onclick="toggleDarkMode()">
                    🌙 <span id="theme-text">Tema Gelap</span>
                </button>
                <button class="btn btn-feature" onclick="exportNotes()">
                    📝 <span id="export-text">Export Nota</span>
                </button>
            </div>
        </div>
        
        <!-- Stats Modal -->
        <div id="stats-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeStats()">&times;</span>
                <h2 id="stats-title">Statistik Pembelajaran</h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-number" id="total-cards">8</div>
                        <div class="stat-label" id="total-label">Jumlah Kad</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="learned-cards">0</div>
                        <div class="stat-label" id="learned-label">Sudah Faham</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="flip-count">0</div>
                        <div class="stat-label" id="flip-label">Kali Flip</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="study-time">0</div>
                        <div class="stat-label" id="time-label">Minit Belajar</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentLanguage = 'bm';
        let currentCardIndex = 0;
        let isFlipped = false;
        let autoPlayInterval = null;
        let isAutoPlaying = false;
        let learnedCards = new Set();
        let flipCount = 0;
        let startTime = Date.now();
        let isDarkMode = false;
        
        const flashcards = {
            bm: [
                {
                    front: {
                        title: "Apakah pola?",
                        content: "Terangkan konsep asas pola dalam matematik."
                    },
                    back: {
                        title: "Jawapan",
                        content: "Pola ialah susunan objek, nombor atau bentuk yang mengikut peraturan tertentu dan berulang secara konsisten."
                    }
                },
                {
                    front: {
                        title: "Jenis-jenis Pola",
                        content: "Nyatakan tiga jenis pola utama."
                    },
                    back: {
                        title: "Jawapan",
                        content: "1. Pola Nombor (contoh: 2, 4, 6, 8...)\n2. Pola Bentuk (contoh: ○△□○△□...)\n3. Pola Warna (contoh: merah-biru-hijau-merah-biru-hijau...)"
                    }
                },
                {
                    front: {
                        title: "Urutan Nombor",
                        content: "Cari sebutan seterusnya:\n5, 10, 15, 20, ?"
                    },
                    back: {
                        title: "Jawapan: 25",
                        content: "Pola: +5 setiap sebutan\n5 → 10 → 15 → 20 → 25\nIni adalah urutan aritmetik dengan beza sepunya = 5"
                    }
                },
                {
                    front: {
                        title: "Pola Bentuk",
                        content: "Lakarkan corak seterusnya:"
                    },
                    back: {
                        title: "Jawapan",
                        content: "Pola berulang: bulatan merah, segi empat biru, segitiga hijau\nCorak berulang setiap 3 unit\nJawapan: Bulatan merah"
                    }
                },
                {
                    front: {
                        title: "Urutan Kuasa Dua",
                        content: "Cari pola:\n1, 4, 9, 16, ?"
                    },
                    back: {
                        title: "Jawapan: 25",
                        content: "Pola: Kuasa dua nombor asli\n1² = 1, 2² = 4, 3² = 9, 4² = 16, 5² = 25\nSebutan ke-n = n²"
                    }
                },
                {
                    front: {
                        title: "Pola Fibonacci",
                        content: "Teruskan urutan:\n1, 1, 2, 3, 5, 8, ?"
                    },
                    back: {
                        title: "Jawapan: 13",
                        content: "Pola Fibonacci: Setiap sebutan = jumlah dua sebutan sebelumnya\n1+1=2, 1+2=3, 2+3=5, 3+5=8, 5+8=13"
                    }
                },
                {
                    front: {
                        title: "Rumus Sebutan ke-n",
                        content: "Untuk urutan 3, 6, 9, 12...\nCari rumus sebutan ke-n"
                    },
                    back: {
                        title: "Jawapan: Tn = 3n",
                        content: "Sebutan pertama (T₁) = 3×1 = 3\nSebutan kedua (T₂) = 3×2 = 6\nSebutan ketiga (T₃) = 3×3 = 9\nMaka, Tn = 3n"
                    }
                },
                {
                    front: {
                        title: "Aplikasi Pola",
                        content: "Berikan contoh pola dalam kehidupan seharian."
                    },
                    back: {
                        title: "Jawapan",
                        content: "• Hari dalam seminggu (Isnin-Ahad berulang)\n• Bulan dalam tahun (Jan-Dis berulang)\n• Corak pada kain batik\n• Susunan bata pada dinding\n• Nada muzik dalam lagu"
                    }
                }
            ],
            en: [
                {
                    front: {
                        title: "What is a pattern?",
                        content: "Explain the basic concept of patterns in mathematics."
                    },
                    back: {
                        title: "Answer",
                        content: "A pattern is an arrangement of objects, numbers, or shapes that follows a specific rule and repeats consistently."
                    }
                },
                {
                    front: {
                        title: "Types of Patterns",
                        content: "State three main types of patterns."
                    },
                    back: {
                        title: "Answer",
                        content: "1. Number Patterns (e.g., 2, 4, 6, 8...)\n2. Shape Patterns (e.g., ○△□○△□...)\n3. Color Patterns (e.g., red-blue-green-red-blue-green...)"
                    }
                },
                {
                    front: {
                        title: "Number Sequence",
                        content: "Find the next term:\n5, 10, 15, 20, ?"
                    },
                    back: {
                        title: "Answer: 25",
                        content: "Pattern: +5 each term\n5 → 10 → 15 → 20 → 25\nThis is an arithmetic sequence with common difference = 5"
                    }
                },
                {
                    front: {
                        title: "Shape Pattern",
                        content: "Draw the next pattern:"
                    },
                    back: {
                        title: "Answer",
                        content: "Repeating pattern: red circle, blue square, green triangle\nPattern repeats every 3 units\nAnswer: Red circle"
                    }
                },
                {
                    front: {
                        title: "Square Number Sequence",
                        content: "Find the pattern:\n1, 4, 9, 16, ?"
                    },
                    back: {
                        title: "Answer: 25",
                        content: "Pattern: Perfect squares\n1² = 1, 2² = 4, 3² = 9, 4² = 16, 5² = 25\nnth term = n²"
                    }
                },
                {
                    front: {
                        title: "Fibonacci Pattern",
                        content: "Continue the sequence:\n1, 1, 2, 3, 5, 8, ?"
                    },
                    back: {
                        title: "Answer: 13",
                        content: "Fibonacci pattern: Each term = sum of two previous terms\n1+1=2, 1+2=3, 2+3=5, 3+5=8, 5+8=13"
                    }
                },
                {
                    front: {
                        title: "nth Term Formula",
                        content: "For sequence 3, 6, 9, 12...\nFind the nth term formula"
                    },
                    back: {
                        title: "Answer: Tn = 3n",
                        content: "First term (T₁) = 3×1 = 3\nSecond term (T₂) = 3×2 = 6\nThird term (T₃) = 3×3 = 9\nTherefore, Tn = 3n"
                    }
                },
                {
                    front: {
                        title: "Pattern Applications",
                        content: "Give examples of patterns in daily life."
                    },
                    back: {
                        title: "Answer",
                        content: "• Days of the week (Mon-Sun repeating)\n• Months of the year (Jan-Dec repeating)\n• Batik fabric designs\n• Brick arrangements on walls\n• Musical notes in songs"
                    }
                }
            ]
        };
        
        function setLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            updateCard();
            updateControls();
        }
        
        function updateCard() {
            const card = flashcards[currentLanguage][currentCardIndex];
            document.getElementById('front-title').textContent = card.front.title;
            document.getElementById('back-title').textContent = card.back.title;
            
            // Special handling for shape pattern cards
            if (currentCardIndex === 3) { // Shape pattern card
                if (card.front.title.includes('Bentuk') || card.front.title.includes('Shape')) {
                    document.getElementById('front-content').innerHTML = `
                        ${card.front.content}
                        <div class="pattern-visual">
                            <div class="shape circle red"></div>
                            <div class="shape square blue"></div>
                            <div class="shape triangle green"></div>
                            <div class="shape circle red"></div>
                            <div class="shape square blue"></div>
                            <div class="shape triangle green"></div>
                            <div style="font-size: 2rem; margin: 0 10px;">?</div>
                        </div>
                    `;
                } else {
                    document.getElementById('front-content').textContent = card.front.content;
                }
                
                document.getElementById('back-content').innerHTML = `
                    ${card.back.content}
                    <div class="pattern-visual">
                        <div class="shape circle red"></div>
                        <div class="shape square blue"></div>
                        <div class="shape triangle green"></div>
                        <div class="shape circle red"></div>
                        <div class="shape square blue"></div>
                        <div class="shape triangle green"></div>
                        <div class="shape circle red" style="border: 3px solid #fff; box-shadow: 0 0 10px rgba(255,255,255,0.8);"></div>
                    </div>
                `;
            } else {
                document.getElementById('front-content').textContent = card.front.content;
                document.getElementById('back-content').textContent = card.back.content;
            }
            
            // Reset flip state
            document.getElementById('flashcard').classList.remove('flipped');
            isFlipped = false;
            
            // Update progress
            const progress = ((currentCardIndex + 1) / flashcards[currentLanguage].length) * 100;
            document.getElementById('progress').style.width = progress + '%';
            
            // Update counter
            document.getElementById('current-card').textContent = currentCardIndex + 1;
            document.getElementById('total-cards').textContent = flashcards[currentLanguage].length;
        }
        
        function updateControls() {
            const controls = document.querySelector('.controls');
            if (currentLanguage === 'bm') {
                controls.innerHTML = `
                    <button class="btn btn-secondary" onclick="previousCard()">⬅ Sebelum</button>
                    <button class="btn btn-primary" onclick="flipCard()">Balikkan Kad</button>
                    <button class="btn btn-secondary" onclick="nextCard()">Seterusnya ➡</button>
                    <button class="btn btn-secondary" onclick="shuffleCards()">🔀 Kacau</button>
                `;
                document.querySelector('.flip-hint').textContent = 'Klik kad untuk membalikkan';
            } else {
                controls.innerHTML = `
                    <button class="btn btn-secondary" onclick="previousCard()">⬅ Previous</button>
                    <button class="btn btn-primary" onclick="flipCard()">Flip Card</button>
                    <button class="btn btn-secondary" onclick="nextCard()">Next ➡</button>
                    <button class="btn btn-secondary" onclick="shuffleCards()">🔀 Shuffle</button>
                `;
                document.querySelector('.flip-hint').textContent = 'Click card to flip';
            }
        }
        
        function flipCard() {
            const flashcard = document.getElementById('flashcard');
            flashcard.classList.toggle('flipped');
            isFlipped = !isFlipped;
            flipCount++;
        }
        
        function nextCard() {
            if (currentCardIndex < flashcards[currentLanguage].length - 1) {
                currentCardIndex++;
                updateCard();
            }
        }
        
        function previousCard() {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                updateCard();
            }
        }
        
        function shuffleCards() {
            const totalCards = flashcards[currentLanguage].length;
            currentCardIndex = Math.floor(Math.random() * totalCards);
            updateCard();
        }
        
        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            switch(e.key) {
                case 'ArrowLeft':
                    previousCard();
                    break;
                case 'ArrowRight':
                    nextCard();
                    break;
                case ' ':
                case 'Enter':
                    e.preventDefault();
                    flipCard();
                    break;
            }
        });
        
        // New Interactive Functions
        function toggleAutoPlay() {
            if (isAutoPlaying) {
                clearInterval(autoPlayInterval);
                isAutoPlaying = false;
                document.getElementById('autoplay-icon').textContent = '▶️';
                document.getElementById('autoplay-text').textContent = currentLanguage === 'bm' ? 'Auto Play' : 'Auto Play';
            } else {
                autoPlayInterval = setInterval(() => {
                    if (!isFlipped) {
                        flipCard();
                    } else {
                        nextCard();
                    }
                }, 3000);
                isAutoPlaying = true;
                document.getElementById('autoplay-icon').textContent = '⏸️';
                document.getElementById('autoplay-text').textContent = currentLanguage === 'bm' ? 'Berhenti' : 'Stop';
            }
        }
        
        function markAsLearned() {
            learnedCards.add(currentCardIndex);
            document.getElementById('flashcard').classList.add('learned-card');
            
            // Update button text
            document.getElementById('learned-icon').textContent = '✅';
            setTimeout(() => {
                document.getElementById('learned-icon').textContent = '⭐';
            }, 1000);
        }
        
        function showStats() {
            const studyTimeMinutes = Math.floor((Date.now() - startTime) / 60000);
            document.getElementById('learned-cards').textContent = learnedCards.size;
            document.getElementById('flip-count').textContent = flipCount;
            document.getElementById('study-time').textContent = studyTimeMinutes;
            document.getElementById('stats-modal').style.display = 'block';
        }
        
        function closeStats() {
            document.getElementById('stats-modal').style.display = 'none';
        }
        
        function resetProgress() {
            if (confirm(currentLanguage === 'bm' ? 'Reset semua progress?' : 'Reset all progress?')) {
                learnedCards.clear();
                flipCount = 0;
                startTime = Date.now();
                currentCardIndex = 0;
                updateCard();
                document.getElementById('flashcard').classList.remove('learned-card');
            }
        }
        
        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark-mode');
            document.getElementById('theme-text').textContent = isDarkMode ? 
                (currentLanguage === 'bm' ? 'Tema Terang' : 'Light Mode') : 
                (currentLanguage === 'bm' ? 'Tema Gelap' : 'Dark Mode');
        }
        
        function exportNotes() {
            let notes = currentLanguage === 'bm' ? 
                'NOTA POLA - MATEMATIK TINGKATAN 2\n\n' : 
                'PATTERNS NOTES - FORM 2 MATHEMATICS\n\n';
            
            flashcards[currentLanguage].forEach((card, index) => {
                notes += `${index + 1}. ${card.front.title}\n`;
                notes += `${card.front.content}\n\n`;
                notes += `Jawapan/Answer:\n${card.back.content}\n\n`;
                notes += '---\n\n';
            });
            
            const blob = new Blob([notes], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = currentLanguage === 'bm' ? 'nota-pola.txt' : 'patterns-notes.txt';
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // Update controls with new language support
        function updateControlsLanguage() {
            if (currentLanguage === 'bm') {
                document.getElementById('autoplay-text').textContent = isAutoPlaying ? 'Berhenti' : 'Auto Play';
                document.getElementById('learned-text').textContent = 'Sudah Faham';
                document.getElementById('stats-text').textContent = 'Statistik';
                document.getElementById('reset-text').textContent = 'Reset';
                document.getElementById('theme-text').textContent = isDarkMode ? 'Tema Terang' : 'Tema Gelap';
                document.getElementById('export-text').textContent = 'Export Nota';
                document.getElementById('stats-title').textContent = 'Statistik Pembelajaran';
                document.getElementById('total-label').textContent = 'Jumlah Kad';
                document.getElementById('learned-label').textContent = 'Sudah Faham';
                document.getElementById('flip-label').textContent = 'Kali Flip';
                document.getElementById('time-label').textContent = 'Minit Belajar';
                
                // Instructions in Malay
                document.getElementById('instruction-title').textContent = '📚 Cara Menggunakan Flash Card Ini';
                document.getElementById('instruction-1').textContent = 'Klik kad atau tekan spacebar untuk membalikkan dan lihat jawapan';
                document.getElementById('instruction-2').textContent = 'Tekan "Sudah Faham" untuk tandakan kad yang sudah dikuasai';
                document.getElementById('instruction-3').textContent = 'Gunakan "Auto Play" untuk pembelajaran automatik setiap 3 saat';
                document.getElementById('instruction-4').textContent = 'Lihat "Statistik" untuk pantau kemajuan pembelajaran anda';
                document.getElementById('instruction-5').textContent = 'Tekan "Export Nota" untuk muat turun semua nota dalam fail .txt untuk rujukan offline';
            } else {
                document.getElementById('autoplay-text').textContent = isAutoPlaying ? 'Stop' : 'Auto Play';
                document.getElementById('learned-text').textContent = 'Learned';
                document.getElementById('stats-text').textContent = 'Statistics';
                document.getElementById('reset-text').textContent = 'Reset';
                document.getElementById('theme-text').textContent = isDarkMode ? 'Light Mode' : 'Dark Mode';
                document.getElementById('export-text').textContent = 'Export Notes';
                document.getElementById('stats-title').textContent = 'Learning Statistics';
                document.getElementById('total-label').textContent = 'Total Cards';
                document.getElementById('learned-label').textContent = 'Learned';
                document.getElementById('flip-label').textContent = 'Flips';
                document.getElementById('time-label').textContent = 'Study Minutes';
                
                // Instructions in English
                document.getElementById('instruction-title').textContent = '📚 How to Use This Flash Card';
                document.getElementById('instruction-1').textContent = 'Click card or press spacebar to flip and see the answer';
                document.getElementById('instruction-2').textContent = 'Press "Learned" to mark cards you have mastered';
                document.getElementById('instruction-3').textContent = 'Use "Auto Play" for automatic learning every 3 seconds';
                document.getElementById('instruction-4').textContent = 'Check "Statistics" to monitor your learning progress';
                document.getElementById('instruction-5').textContent = 'Press "Export Notes" to download all notes as .txt file for offline reference';
            }
        }
        
        // Update the existing updateCard function
        function updateCardWithLearned() {
            updateCard();
            if (learnedCards.has(currentCardIndex)) {
                document.getElementById('flashcard').classList.add('learned-card');
            } else {
                document.getElementById('flashcard').classList.remove('learned-card');
            }
        }
        
        // Override existing functions
        function nextCard() {
            if (currentCardIndex < flashcards[currentLanguage].length - 1) {
                currentCardIndex++;
                updateCardWithLearned();
            }
        }
        
        function previousCard() {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                updateCardWithLearned();
            }
        }
        
        function shuffleCards() {
            const totalCards = flashcards[currentLanguage].length;
            currentCardIndex = Math.floor(Math.random() * totalCards);
            updateCardWithLearned();
        }
        
        // Update setLanguage function
        function setLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            updateCardWithLearned();
            updateControls();
            updateControlsLanguage();
        }
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('stats-modal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }
        
        // Initialize
        updateCard();
        updateControls();
        updateControlsLanguage();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98163b7ba1a146c4',t:'MTc1ODI1NTAxNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
