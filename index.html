<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulasi Gabungan Operasi Ungkapan Algebra</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #2d3748;
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
            line-height: 1.2;
        }

        .header p {
            color: #718096;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .language-toggle {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .lang-btn {
            background: #e2e8f0;
            color: #4a5568;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .lang-btn:hover {
            background: #cbd5e0;
        }

        .lang-btn.active {
            background: #4299e1;
            color: white;
        }

        .english {
            opacity: 0.7;
            font-size: 0.9em;
        }

        .hidden {
            display: none;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #f7fafc;
            padding: 10px 20px;
            border-radius: 15px;
            border: 2px solid #e2e8f0;
        }

        .block {
            width: 30px;
            height: 30px;
            border-radius: 8px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 14px;
        }

        .x-block { background: #3182ce; }
        .y-block { background: #38a169; }
        .number-block { 
            background: #ed8936; 
            width: 20px; 
            height: 20px; 
            border-radius: 50%;
        }
        .constant-block { background: #805ad5; }

        .question-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .question-btn {
            background: #4299e1;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 15px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .question-btn:hover {
            background: #3182ce;
            transform: translateY(-2px);
        }

        .question-btn.active {
            background: #2b6cb0;
            box-shadow: 0 5px 15px rgba(66, 153, 225, 0.4);
        }

        .simulation-area {
            background: #f8fafc;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            min-height: 400px;
        }

        .step {
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            border-left: 5px solid #4299e1;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }

        .step.active {
            opacity: 1;
            transform: translateY(0);
        }

        .step-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .step-number {
            background: #4299e1;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
        }

        .expression {
            font-size: 1.5rem;
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: #edf2f7;
            border-radius: 15px;
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-weight: 500;
            line-height: 1.6;
        }

        .math-fraction {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            margin: 0 8px;
            vertical-align: middle;
        }

        .math-numerator, .math-denominator {
            padding: 4px 8px;
            font-size: 1.1rem;
        }

        .math-fraction-line {
            width: 100%;
            height: 2px;
            background: #2d3748;
            margin: 2px 0;
            min-width: 60px;
        }

        .math-operator {
            font-size: 1.8rem;
            margin: 0 12px;
            color: #e53e3e;
            font-weight: 600;
        }

        .visual-blocks {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .fraction-visual {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 10px;
        }

        .numerator, .denominator {
            display: flex;
            gap: 5px;
            align-items: center;
            padding: 10px;
            min-height: 40px;
            justify-content: center;
        }

        .fraction-line {
            width: 100%;
            height: 3px;
            background: #2d3748;
            margin: 5px 0;
        }

        .operator {
            font-size: 2rem;
            font-weight: bold;
            color: #e53e3e;
            margin: 0 15px;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }

        .control-btn {
            background: #48bb78;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: #38a169;
            transform: translateY(-2px);
        }

        .control-btn:disabled {
            background: #a0aec0;
            cursor: not-allowed;
            transform: none;
        }

        .explanation {
            background: #e6fffa;
            border: 2px solid #81e6d9;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            color: #234e52;
        }

        .highlight {
            background: #fed7d7;
            padding: 2px 6px;
            border-radius: 4px;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .fade-in {
            animation: fadeIn 0.8s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .legend {
                gap: 15px;
            }
            
            .question-selector {
                flex-direction: column;
                align-items: center;
            }
            
            .expression {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧮 <span class="malay">Gabungan Operasi Ungkapan Algebra</span> <span class="english">/ Algebraic Expression Operations</span></h1>
            <p><span class="malay">Matematik Tingkatan 2, Bab 2</span> <span class="english">/ Form 2 Mathematics, Chapter 2</span></p>
            <div class="language-toggle">
                <button class="lang-btn active" onclick="toggleLanguage('ms')">🇲🇾 Bahasa Malaysia</button>
                <button class="lang-btn" onclick="toggleLanguage('en')">🇬🇧 English</button>
            </div>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="block x-block">x</div>
                <span class="malay">Pembolehubah x</span>
                <span class="english hidden">Variable x</span>
            </div>
            <div class="legend-item">
                <div class="block y-block">y</div>
                <span class="malay">Pembolehubah y</span>
                <span class="english hidden">Variable y</span>
            </div>
            <div class="legend-item">
                <div class="block number-block">2</div>
                <span class="malay">Nombor</span>
                <span class="english hidden">Number</span>
            </div>
            <div class="legend-item">
                <div class="block constant-block">a</div>
                <span class="malay">Pemalar lain</span>
                <span class="english hidden">Other constants</span>
            </div>
        </div>

        <div class="question-selector">
            <button class="question-btn active" onclick="selectQuestion(1)">
                <span class="malay">Soalan (i): Penambahan Pecahan</span>
                <span class="english hidden">Question (i): Addition of Fractions</span>
            </button>
            <button class="question-btn" onclick="selectQuestion(2)">
                <span class="malay">Soalan (ii): Pembahagian Pecahan</span>
                <span class="english hidden">Question (ii): Division of Fractions</span>
            </button>
        </div>

        <div class="simulation-area" id="simulationArea">
            <!-- Kandungan simulasi akan dipaparkan di sini -->
        </div>

        <div class="controls">
            <button class="control-btn" id="autoPlayBtn" onclick="toggleAutoPlay()">
                ▶️ <span class="malay">Auto Play</span><span class="english hidden">Auto Play</span>
            </button>
            <button class="control-btn" id="prevBtn" onclick="previousStep()" disabled>
                ⬅️ <span class="malay">Langkah Sebelum</span><span class="english hidden">Previous Step</span>
            </button>
            <button class="control-btn" id="nextBtn" onclick="nextStep()">
                <span class="malay">Langkah Seterusnya</span><span class="english hidden">Next Step</span> ➡️
            </button>
            <button class="control-btn" onclick="resetSimulation()">
                🔄 <span class="malay">Mula Semula</span><span class="english hidden">Reset</span>
            </button>
        </div>
    </div>

    <script>
        let currentQuestion = 1;
        let currentStep = 0;
        let maxSteps = 0;
        let currentLanguage = 'ms';
        let autoPlayInterval = null;
        let isAutoPlaying = false;

        const questions = {
            1: {
                title: {
                    ms: "Penambahan Pecahan Algebra",
                    en: "Addition of Algebraic Fractions"
                },
                mathExpression: `<div class="math-fraction"><div class="math-numerator">xy - 2y</div><div class="math-fraction-line"></div><div class="math-denominator">3x - 6</div></div><span class="math-operator">+</span><div class="math-fraction"><div class="math-numerator">x² - y²</div><div class="math-fraction-line"></div><div class="math-denominator">5xy + 5y²</div></div>`,
                steps: [
                    {
                        title: {
                            ms: "Soalan Asal",
                            en: "Original Question"
                        },
                        expression: `<div class="math-fraction"><div class="math-numerator">xy - 2y</div><div class="math-fraction-line"></div><div class="math-denominator">3x - 6</div></div><span class="math-operator">+</span><div class="math-fraction"><div class="math-numerator">x² - y²</div><div class="math-fraction-line"></div><div class="math-denominator">5xy + 5y²</div></div>`,
                        visual: "original1",
                        explanation: {
                            ms: "Kita perlu menyelesaikan penambahan dua pecahan algebra ini langkah demi langkah.",
                            en: "We need to solve this addition of two algebraic fractions step by step."
                        }
                    },
                    {
                        title: {
                            ms: "Langkah 1: Faktorkan Pengangka dan Penyebut",
                            en: "Step 1: Factorize Numerator and Denominator"
                        },
                        expression: `<div class="math-fraction"><div class="math-numerator">y(x - 2)</div><div class="math-fraction-line"></div><div class="math-denominator">3(x - 2)</div></div><span class="math-operator">+</span><div class="math-fraction"><div class="math-numerator">(x - y)(x + y)</div><div class="math-fraction-line"></div><div class="math-denominator">5y(x + y)</div></div>`,
                        visual: "factor1",
                        explanation: {
                            ms: "Faktorkan setiap bahagian: xy - 2y = y(x - 2), 3x - 6 = 3(x - 2), x² - y² = (x - y)(x + y), 5xy + 5y² = 5y(x + y)",
                            en: "Factor each part: xy - 2y = y(x - 2), 3x - 6 = 3(x - 2), x² - y² = (x - y)(x + y), 5xy + 5y² = 5y(x + y)"
                        }
                    },
                    {
                        title: {
                            ms: "Langkah 2: Permudahkan Pecahan",
                            en: "Step 2: Simplify Fractions"
                        },
                        expression: `<div class="math-fraction"><div class="math-numerator">y</div><div class="math-fraction-line"></div><div class="math-denominator">3</div></div><span class="math-operator">+</span><div class="math-fraction"><div class="math-numerator">x - y</div><div class="math-fraction-line"></div><div class="math-denominator">5y</div></div>`,
                        visual: "simplify1",
                        explanation: {
                            ms: "Batalkan faktor sama: (x - 2) dalam pecahan pertama, (x + y) dalam pecahan kedua",
                            en: "Cancel common factors: (x - 2) in first fraction, (x + y) in second fraction"
                        }
                    },
                    {
                        title: {
                            ms: "Langkah 3: Cari Penyebut Sepunya Terkecil (PST)",
                            en: "Step 3: Find Lowest Common Multiple (LCM)"
                        },
                        expression: `<div class="math-fraction"><div class="math-numerator">5y²</div><div class="math-fraction-line"></div><div class="math-denominator">15y</div></div><span class="math-operator">+</span><div class="math-fraction"><div class="math-numerator">3(x - y)</div><div class="math-fraction-line"></div><div class="math-denominator">15y</div></div>`,
                        visual: "lcm1",
                        explanation: {
                            ms: "PST untuk 3 dan 5y adalah 15y. Darabkan pengangka dan penyebut dengan faktor yang sesuai.",
                            en: "LCM of 3 and 5y is 15y. Multiply numerator and denominator by appropriate factors."
                        }
                    },
                    {
                        title: {
                            ms: "Langkah 4: Tambahkan Pecahan",
                            en: "Step 4: Add Fractions"
                        },
                        expression: `<div class="math-fraction"><div class="math-numerator">5y² + 3x - 3y</div><div class="math-fraction-line"></div><div class="math-denominator">15y</div></div>`,
                        visual: "add1",
                        explanation: {
                            ms: "Gabungkan pengangka: 5y² + 3(x - y) = 5y² + 3x - 3y",
                            en: "Combine numerators: 5y² + 3(x - y) = 5y² + 3x - 3y"
                        }
                    },
                    {
                        title: {
                            ms: "Jawapan Akhir",
                            en: "Final Answer"
                        },
                        expression: `<div class="math-fraction"><div class="math-numerator">3x + 5y² - 3y</div><div class="math-fraction-line"></div><div class="math-denominator">15y</div></div>`,
                        visual: "final1",
                        explanation: {
                            ms: "Susun semula sebutan dalam pengangka untuk mendapat jawapan akhir yang kemas.",
                            en: "Rearrange terms in numerator to get the neat final answer."
                        }
                    }
                ]
            },
            2: {
                title: {
                    ms: "Pembahagian Pecahan Algebra",
                    en: "Division of Algebraic Fractions"
                },
                mathExpression: `<div class="math-fraction"><div class="math-numerator">4a² - b²</div><div class="math-fraction-line"></div><div class="math-denominator">c - d</div></div><span class="math-operator">÷</span><div class="math-fraction"><div class="math-numerator">6a - 3b</div><div class="math-fraction-line"></div><div class="math-denominator">2c - 2d</div></div>`,
                steps: [
                    {
                        title: {
                            ms: "Soalan Asal",
                            en: "Original Question"
                        },
                        expression: `<div class="math-fraction"><div class="math-numerator">4a² - b²</div><div class="math-fraction-line"></div><div class="math-denominator">c - d</div></div><span class="math-operator">÷</span><div class="math-fraction"><div class="math-numerator">6a - 3b</div><div class="math-fraction-line"></div><div class="math-denominator">2c - 2d</div></div>`,
                        visual: "original2",
                        explanation: {
                            ms: "Kita perlu menyelesaikan pembahagian dua pecahan algebra ini.",
                            en: "We need to solve this division of two algebraic fractions."
                        }
                    },
                    {
                        title: "Langkah 1: Tukar Pembahagian kepada Pendaraban",
                        expression: "((4a² - b²)/(c - d)) × ((2c - 2d)/(6a - 3b))",
                        visual: "division2",
                        explanation: "Pembahagian pecahan = pendaraban dengan songsang pecahan kedua"
                    },
                    {
                        title: "Langkah 2: Faktorkan Semua Sebutan",
                        expression: "((2a - b)(2a + b)/(c - d)) × (2(c - d)/(3(2a - b)))",
                        visual: "factor2",
                        explanation: "4a² - b² = (2a - b)(2a + b), 6a - 3b = 3(2a - b), 2c - 2d = 2(c - d)"
                    },
                    {
                        title: "Langkah 3: Susun Semula untuk Mudah Dibatalkan",
                        expression: "((2a - b)(2a + b) × 2(c - d))/((c - d) × 3(2a - b))",
                        visual: "rearrange2",
                        explanation: "Susun dalam bentuk pecahan tunggal untuk mudah melihat faktor yang boleh dibatalkan"
                    },
                    {
                        title: "Langkah 4: Batalkan Faktor Sama",
                        expression: "(2a + b) × 2 / 3 = 2(2a + b)/3",
                        visual: "cancel2",
                        explanation: "Batalkan (2a - b) dan (c - d) yang muncul dalam pengangka dan penyebut"
                    },
                    {
                        title: "Jawapan Akhir",
                        expression: "(4a + 2b)/3",
                        visual: "final2",
                        explanation: "Kembangkan 2(2a + b) = 4a + 2b untuk mendapat jawapan akhir"
                    }
                ]
            }
        };

        function selectQuestion(questionNum) {
            currentQuestion = questionNum;
            currentStep = 0;
            
            // Update button states
            document.querySelectorAll('.question-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            maxSteps = questions[questionNum].steps.length - 1;
            updateSimulation();
            updateControls();
        }

        function updateSimulation() {
            const question = questions[currentQuestion];
            const step = question.steps[currentStep];
            
            const simulationArea = document.getElementById('simulationArea');
            
            simulationArea.innerHTML = `
                <div class="step active fade-in">
                    <div class="step-title">
                        <div class="step-number">${currentStep + 1}</div>
                        ${typeof step.title === 'object' ? step.title[currentLanguage] : step.title}
                    </div>
                    <div class="expression">${step.expression}</div>
                    <div class="visual-blocks" id="visualBlocks">
                        ${generateVisualBlocks(step.visual)}
                    </div>
                    <div class="explanation">
                        💡 <strong><span class="malay">Penjelasan:</span><span class="english hidden">Explanation:</span></strong> ${typeof step.explanation === 'object' ? step.explanation[currentLanguage] : step.explanation}
                    </div>
                </div>
            `;
        }

        function toggleLanguage(lang) {
            currentLanguage = lang;
            
            // Update button states
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Toggle visibility of language elements
            if (lang === 'ms') {
                document.querySelectorAll('.malay').forEach(el => el.classList.remove('hidden'));
                document.querySelectorAll('.english').forEach(el => el.classList.add('hidden'));
            } else {
                document.querySelectorAll('.malay').forEach(el => el.classList.add('hidden'));
                document.querySelectorAll('.english').forEach(el => el.classList.remove('hidden'));
            }
            
            updateSimulation();
            updateControls();
        }

        function toggleAutoPlay() {
            const autoPlayBtn = document.getElementById('autoPlayBtn');
            
            if (isAutoPlaying) {
                clearInterval(autoPlayInterval);
                isAutoPlaying = false;
                autoPlayBtn.innerHTML = `▶️ <span class="malay">Auto Play</span><span class="english hidden">Auto Play</span>`;
                autoPlayBtn.style.background = '#48bb78';
            } else {
                isAutoPlaying = true;
                autoPlayBtn.innerHTML = `⏸️ <span class="malay">Berhenti</span><span class="english hidden">Pause</span>`;
                autoPlayBtn.style.background = '#e53e3e';
                
                autoPlayInterval = setInterval(() => {
                    if (currentStep < maxSteps) {
                        nextStep();
                    } else {
                        toggleAutoPlay(); // Stop when reaching the end
                    }
                }, 3000); // 3 seconds interval
            }
        }

        function generateVisualBlocks(visualType) {
            switch(visualType) {
                case 'original1':
                    return `
                        <div class="fraction-visual">
                            <div class="numerator">
                                <div class="block x-block">x</div>
                                <div class="block y-block">y</div>
                                <span>-</span>
                                <div class="number-block">2</div>
                                <div class="block y-block">y</div>
                            </div>
                            <div class="fraction-line"></div>
                            <div class="denominator">
                                <div class="number-block">3</div>
                                <div class="block x-block">x</div>
                                <span>-</span>
                                <div class="number-block">6</div>
                            </div>
                        </div>
                        <div class="operator">+</div>
                        <div class="fraction-visual">
                            <div class="numerator">
                                <div class="block x-block">x</div>
                                <span>²-</span>
                                <div class="block y-block">y</div>
                                <span>²</span>
                            </div>
                            <div class="fraction-line"></div>
                            <div class="denominator">
                                <div class="number-block">5</div>
                                <div class="block x-block">x</div>
                                <div class="block y-block">y</div>
                                <span>+</span>
                                <div class="number-block">5</div>
                                <div class="block y-block">y</div>
                                <span>²</span>
                            </div>
                        </div>
                    `;
                
                case 'factor1':
                    return `
                        <div class="fraction-visual">
                            <div class="numerator">
                                <div class="block y-block">y</div>
                                <span>(</span>
                                <div class="block x-block">x</div>
                                <span>-</span>
                                <div class="number-block">2</div>
                                <span>)</span>
                            </div>
                            <div class="fraction-line"></div>
                            <div class="denominator">
                                <div class="number-block">3</div>
                                <span>(</span>
                                <div class="block x-block highlight">x</div>
                                <span class="highlight">-</span>
                                <div class="number-block highlight">2</div>
                                <span>)</span>
                            </div>
                        </div>
                        <div class="operator">+</div>
                        <div class="fraction-visual">
                            <div class="numerator">
                                <span>(</span>
                                <div class="block x-block">x</div>
                                <span>-</span>
                                <div class="block y-block">y</div>
                                <span>)(</span>
                                <div class="block x-block highlight">x</div>
                                <span class="highlight">+</span>
                                <div class="block y-block highlight">y</div>
                                <span>)</span>
                            </div>
                            <div class="fraction-line"></div>
                            <div class="denominator">
                                <div class="number-block">5</div>
                                <div class="block y-block">y</div>
                                <span>(</span>
                                <div class="block x-block highlight">x</div>
                                <span class="highlight">+</span>
                                <div class="block y-block highlight">y</div>
                                <span>)</span>
                            </div>
                        </div>
                    `;
                
                case 'simplify1':
                    return `
                        <div class="fraction-visual">
                            <div class="numerator">
                                <div class="block y-block">y</div>
                            </div>
                            <div class="fraction-line"></div>
                            <div class="denominator">
                                <div class="number-block">3</div>
                            </div>
                        </div>
                        <div class="operator">+</div>
                        <div class="fraction-visual">
                            <div class="numerator">
                                <div class="block x-block">x</div>
                                <span>-</span>
                                <div class="block y-block">y</div>
                            </div>
                            <div class="fraction-line"></div>
                            <div class="denominator">
                                <div class="number-block">5</div>
                                <div class="block y-block">y</div>
                            </div>
                        </div>
                    `;
                
                case 'original2':
                    return `
                        <div class="fraction-visual">
                            <div class="numerator">
                                <div class="number-block">4</div>
                                <div class="block constant-block">a</div>
                                <span>²-</span>
                                <div class="block constant-block">b</div>
                                <span>²</span>
                            </div>
                            <div class="fraction-line"></div>
                            <div class="denominator">
                                <div class="block constant-block">c</div>
                                <span>-</span>
                                <div class="block constant-block">d</div>
                            </div>
                        </div>
                        <div class="operator">÷</div>
                        <div class="fraction-visual">
                            <div class="numerator">
                                <div class="number-block">6</div>
                                <div class="block constant-block">a</div>
                                <span>-</span>
                                <div class="number-block">3</div>
                                <div class="block constant-block">b</div>
                            </div>
                            <div class="fraction-line"></div>
                            <div class="denominator">
                                <div class="number-block">2</div>
                                <div class="block constant-block">c</div>
                                <span>-</span>
                                <div class="number-block">2</div>
                                <div class="block constant-block">d</div>
                            </div>
                        </div>
                    `;
                
                default:
                    return '<div style="text-align: center; color: #718096;">Visualisasi akan dipaparkan di sini</div>';
            }
        }

        function nextStep() {
            if (currentStep < maxSteps) {
                currentStep++;
                updateSimulation();
                updateControls();
            }
        }

        function previousStep() {
            if (currentStep > 0) {
                currentStep--;
                updateSimulation();
                updateControls();
            }
        }

        function resetSimulation() {
            currentStep = 0;
            updateSimulation();
            updateControls();
        }

        function updateControls() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.disabled = currentStep === 0;
            nextBtn.disabled = currentStep === maxSteps;
            
            if (currentStep === maxSteps) {
                nextBtn.innerHTML = currentLanguage === 'ms' ? 
                    '🎉 <span class="malay">Selesai!</span><span class="english hidden">Complete!</span>' : 
                    '🎉 <span class="malay hidden">Selesai!</span><span class="english">Complete!</span>';
            } else {
                nextBtn.innerHTML = currentLanguage === 'ms' ? 
                    '<span class="malay">Langkah Seterusnya</span><span class="english hidden">Next Step</span> ➡️' : 
                    '<span class="malay hidden">Langkah Seterusnya</span><span class="english">Next Step</span> ➡️';
            }
        }

        // Initialize simulation
        window.onload = function() {
            maxSteps = questions[currentQuestion].steps.length - 1;
            updateSimulation();
            updateControls();
        };
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9848a9e032e8a559',t:'MTc1ODc4MzgyNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
